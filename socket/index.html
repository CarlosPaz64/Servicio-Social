<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trámites Verificación</title>
    <link rel="stylesheet" href="/stylesSocket.css">
</head>
<body>
    <div class="table-users">
        <div class="header">Trámites Verificación</div>
        
        <table cellspacing="0">
           <thead>
               <tr>
                  <th>Folio</th>
                  <th>ID Único</th>
                  <th>CURP</th>
                  <th>Nombre Completo</th>
                  <th>Trámite</th>
                  <th>Comentario</th>
               </tr>
           </thead>
           <tbody id="tramitesTable">
               <!-- Los datos se insertarán aquí -->
           </tbody>
        </table>
     </div>

     <!-- Incluir el cliente de Socket.io -->
     <script src="/socket.io/socket.io.js"></script>
     <script>
         const socket = io();

         // Función para agregar un registro a la tabla
         function addRowToTable(tramite) {
             const tramitesTable = document.getElementById('tramitesTable');
             const row = document.createElement('tr');
             row.innerHTML = `
                 <td>${tramite.num_folio}</td>
                 <td>${tramite.id_unico}</td>
                 <td>${tramite.curp}</td>
                 <td>${tramite.fullname}</td>
                 <td>${tramite.tramite}</td>
                 <td>${tramite.comentario}</td>
             `;
             tramitesTable.appendChild(row);
         }

         // Cargar todos los registros actuales al iniciar
         fetch('/formularioEstatus/api/tramites')
             .then(response => response.json())
             .then(data => {
                 data.forEach(tramite => {
                     addRowToTable(tramite);
                 });
             })
             .catch(error => console.error('Error al cargar los trámites:', error));

         // Recibir un nuevo registro del servidor
         socket.on('newRecord', (tramite) => {
             addRowToTable(tramite);
         });
     </script>
</body>
</html>
